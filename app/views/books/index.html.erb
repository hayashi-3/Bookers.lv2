<!DOCTYPE html>
<html>
<head>
<script src="https://kit.fontawesome.com/0c5d92a319.js" crossorigin="anonymous"></script>
</head>
<%=flash[:notice] %>
<!-- 投稿内容 -->
    <div class="container">
    <div class="row">
      <div class="col-xs-3">
        <%= render 'books/book',book: @book,user: @user %>
        </div>
        <div class="top"></div>
        <div class="col-xs-9">
        <h2>Books</h2>
        <table class="table">
        <thead>
        <tr>
            <th width="200">Title</th>
            <th width="300">Opinion</th>
            <th colspan="3"></th>
        </tr>
        </thead>
        <tbody>
        <!-- 本の一覧 -->
        <% @books.each do |book| %>
        <tr>
            <th><%= link_to user_path(book.user.id) do %><%= attachment_image_tag book.user, :profile_image, fallback: "no_image.jpeg", size: '40x40'%>
            <% end %>
            </th>
            <th>
            <%= link_to book.title, book_path(book.id) %></th>
            <th><%= book.body %></th>

            <!-- コメント数 -->
            <th>
            <%= link_to "#{book.book_comments.count} コメント数：" %>
            </th>
            <!-- いいね機能 -->
            <% if @book.favorited_by?(current_user) %>
                <tr>
                    <%= link_to book_favorites_path(@book_show), method: :delete do %>
                    <i class="fa fa-heart" aria-hidden="true" style="color: red;"></i>
                    <%= @book.favorites.count %> いいね
                </tr>
            <% else %>
                <tr>
                    <%= link_to book_favorites_path(@book), method: :book do %>
                    <i class="fa fa-heart-o" aria-hidden="true"></i>
                    <%= @book.favorites.count %> いいね
            <% end %>
            <% if current_user.already_liked?(@book) %>
                    <%= button_to 'いいねを取り消す', book_like_path(@book), method: :delete %>
            <% else %>
            <%= button_to 'いいね', book_likes_path(@book) %>
            <% end %>
            </tr>
        <% end %>
            <th><div class="comment-list bt style-2" id="comments">
                <div class="float-wrapper">
                <div class="comment-count"><%= @book_comments.count %>件コメント</div>
                </div>
            </th>
        </tr>
        <% end %>
        <% end %>
        </tbody>
        </table>
      </div>
    </div>
    </div>
<html>